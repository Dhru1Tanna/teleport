---
title: EC2 Tags as Teleport Node Labels
description: How to set up Teleport Node labels based on EC2 tags
h1: Sync EC2 Tags and Teleport Node Labels
---

As of [version], Teleport will automatically detect and import EC2 tags as Teleport labels. Labels created this way will have the `aws/` prefix.

[screenshot of teleport nodes with aws labels]

Teleport will add labels to:

- SSH Nodes
- Apps*
- Databases*
- Kubernetes clusters*

*For services that proxy multiple resources, each resource will receive the same EC2 labels.

## Prerequisites

(!docs/pages/includes/edition-prereqs-tabs.mdx!)

- One Teleport Node running on an Amazon EC2 instance. See
  [Adding Nodes](../admin/adding-nodes.mdx) for how to set up a Teleport Node.
- Tags must be enabled in instance metadata. See [below] for instructions to enable.

## Enable tags in instance metadata

[docs link](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Using_Tags.html#allow-access-to-tags-in-IMDS)

### AWS EC2 Console

When launching a new instance:
- Select `Advanced Details`
- Ensure that `Metadata accessible` is not disabled
- Enable `Allow tags in metadata`

[screenshot of new instance settings]

When modifying an existing instance:
- From instance summary, go to `Actions -> Instance Settings -> Allow tags in instance metadata`
- Set to `Allow`

[screenshot of menu]
[screenshot of allow]

[TODO: determine if restart is required and put answer here]

### AWS CLI

To modify at launch:

```code
aws ec2 run-instances \
    --image-id <image-id> \
    --instance-type <instance-type> \
    ...
    --metadata-options "InstanceMetadataTags=enabled"
```

To modify a running instance:

```code
aws ec2 modify-instance-metadata-options \
    --instance-id i-123456789example \
    --instance-metadata-tags enabled
```

## [notes]

Instances that are not running on the [Nitro system](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-types.html#ec2-nitro-instances) [must be restarted to update tags](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Using_Tags.html#work-with-tags-in-IMDS).
